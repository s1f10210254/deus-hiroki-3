datasource db {
  provider = "postgresql"
  url      = env("API_DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id                 String  @id @default(uuid())
  email              String  @unique
  name               String?
  gamesPlayed        Int     @default(0)
  gamesWon           Int     @default(0)
  gamesLost          Int     @default(0)
  gamesTied          Int     @default(0)
  matchesAsPlayerOne Match[] @relation("PlayerOneMatches")
  matchesAsPlayerTwo Match[] @relation("PlayerTwoMatches")
}

model Match {
  id              String      @id @default(uuid())
  createdAt       DateTime    @default(now())
  playerOneId     String
  playerTwoId     String
  playerOneChoice HandChoice
  playerTwoChoice HandChoice
  result          MatchResult
  playerOne       User        @relation(name: "PlayerOneMatches", fields: [playerOneId], references: [id])
  playerTwo       User        @relation(name: "PlayerTwoMatches", fields: [playerTwoId], references: [id])
}

enum HandChoice {
  ROCK
  PAPER
  SCISSORS
}

enum MatchResult {
  PLAYER_ONE_WON
  PLAYER_TWO_WON
  TIE
  PENDING
}
